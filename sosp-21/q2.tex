\subsection{Open Loop}
\label{sec:q2}
\begin{itemize}
\item Q3: How do different OSes exploit idle periods to halt and save energy?
\item Q4: How do different tuning impact different OSes?
\end{itemize}

%For open loop applications, if SLA is the most important (e.g., 99\% tail latency less than 500 \micro s) then the configuration with lowest absolute energy should always be selected. However, it may also be useful to consider a lower tail latency if it doesn't involve a dramatic increase in energy use. For both workloads, we find that Linux typically trades off increases in energy and decrease in tail latency to arrive at its min EPP setting while the libOS decreases both energy and tail latency.

Across the different QPSes in memcached, tuning Linux (30, 0x1d00, 135) can lower its EPP by up to 22\% while tuning the libOS (2, 0xf00, 55) can lower its EPP by up to 74\%. The libOS was able to set ITR, DVFS and RAPL all at lowest setting in memcached. This result is not surprsing given the throughput performances in ~\ref{sec:perf_baseline}, as a QPS of 600K is considered relatively light for the libOS while for Linux it is approaching its peak. Examining the log data we also find that in the min EPP across all the QPS loads, tuned Linux typically increased of its energy by 5\%-10\%  and reduced its 99\% tail latency by 18\%-26\%, whereas libOS' was able to reduce both energy and tail latency by up to 40\% and 56\% respectively. For memcached-silo, we see similar trade-offs of energy (4\%-7\%) for lower tail latency (22\% - 37\%) in Linux tuned and both a reduction in energy (39\%-48\%) and tail latency (24\%-38\%) in libOS. Given the processing heavier aspects of memcached-silo the DVFS and RAPL values are all set at higher values. However, we still see the libOS being able to lower its DVFS and RAPL to lower levels compared to Linux tuned. The ITR delay has also increased in both libOS and Linux to a range between 10 \micro s-40 \micro s.

%For the libOS, we find in all the three QPS loads, the best ITR value was 2 \micro s; which is the lowest value examined. For tuned Linux, the best ITR values range from 10 \micro s at 200k QPS up to 30 \micro s at 600K QPS. At 200K and 400K QPS, tuned Linux set its DVFS and RAPL at the median ranges and at the highest QPS load of 600K, Linux tuned set DVFS and RAPL at the highest value. 

%In memcached for 200K,400K QPS, Linux tuned had higher number of interrupts than defaults, likewise had higher number of halt states called than Linux default, however the number of energy use increased - a low static ITR at low QPS causes work to be done fast, wakes up idle scheduler and and causes more sleep states to be used, however this could indicate the algorithm isnâ€™t performing as efficiently as even though number of sleep states used increased, the energy used increased as well, indicating the time to sleep actually was much shorter and therefore incur extra costs.

Another interesting tradeoff can be observed in overview figure~\ref{fig:mcdov}, where tuned Linux can drastically lower its energy consumption by up to 50\% if it is willing to sacrifice most of its 500 \micro s SLA budget. We find this is possible by aggressively setting ITR delay at much higher values of 300-400 \micro s. Using an 600K QPS in memcached as an example, we find that compared to default Linux, a tuned Linux with an ITR delay of 300 \micro s can lower its energy use by 44\% through a combination of: 1) 93\% reduction in total interrupts, 2) 30\% reduction in instruction use and last-level cache misses, and 3) a 12X increase in C1E, C3 sleep states, and 2X increase in C7 sleep states. To summarize, tuning Linux with a high ITR delay allows it to go to deeper sleep states and more often, further, the amount of reduced interrupt contents also contributed to less code being executed overall. Moreover, we find that it is able to lower its DVFS at a lower level than tuned Linux for minimum EPP, we hypothesize this is related to the fewer amount of non-application related work that is being done. We do not observe this dramatic of an energy savings in the libOS (only 14\% at 600K QPS), we suspect this effect comes into play at greater efficiences only at much higher QPS for the libOS. There have been a plethora of past work in reducing energy use of workloads such as memcached as it exhibits a diurnal pattern where periods of low utilization exist~\cite{hotpower2008, powernap, napsac}, tuning ITR delay can be an additional lever to further reduce a systems' overall energy use. We also find this trade-off to exist in memcached-silo where in tuned Linux can save energy by up to 47\%, and for the libOS, a smaller fraction of additional energy savings of up to 14\% can be gained.


